<UserControl
    x:Class="LightBulb.Views.Components.Settings.LocationSettingsTabView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:LightBulb.Converters"
    xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
    xmlns:settings="clr-namespace:LightBulb.ViewModels.Components.Settings"
    x:DataType="settings:LocationSettingsTabViewModel">
    <StackPanel Margin="16" Orientation="Vertical">
        <!--  Manual/location-based configuration  -->
        <TextBlock Text="{Binding LocalizationManager.SolarConfigLabel}" />
        <DockPanel Margin="0,8,0,0">
            <RadioButton
                Content="{Binding LocalizationManager.ManualLabel}"
                DockPanel.Dock="Left"
                IsChecked="{Binding IsManualSunriseSunsetEnabled}"
                ToolTip.Tip="{Binding LocalizationManager.ManualTooltip}" />
            <RadioButton
                HorizontalAlignment="Right"
                Content="{Binding LocalizationManager.LocationBasedLabel}"
                DockPanel.Dock="Right"
                IsChecked="{Binding !IsManualSunriseSunsetEnabled}"
                ToolTip.Tip="{Binding LocalizationManager.LocationBasedTooltip}" />
        </DockPanel>

        <!--  Manual  -->
        <StackPanel
            Margin="0,24,0,0"
            IsVisible="{Binding IsManualSunriseSunsetEnabled}"
            Orientation="Vertical">
            <!--  Sunrise time  -->
            <DockPanel>
                <TextBlock DockPanel.Dock="Left" Text="{Binding LocalizationManager.SunriseTimeLabel}" />
                <TextBox
                    MinWidth="24"
                    HorizontalAlignment="Right"
                    DockPanel.Dock="Right"
                    Text="{Binding ManualSunrise, Converter={x:Static converters:TimeOnlyToStringConverter.Instance}, UpdateSourceTrigger=LostFocus}"
                    Theme="{DynamicResource CompactTextBox}" />
            </DockPanel>
            <Slider
                Margin="0,12,0,0"
                LargeChange="0.5"
                Maximum="23.99999"
                Minimum="0"
                SmallChange="0.25"
                Value="{Binding ManualSunrise, Converter={x:Static converters:TimeOnlyToHoursDoubleConverter.Instance}}" />

            <!--  Sunset time  -->
            <DockPanel Margin="0,16,0,0">
                <TextBlock DockPanel.Dock="Left" Text="{Binding LocalizationManager.SunsetTimeLabel}" />
                <TextBox
                    MinWidth="24"
                    HorizontalAlignment="Right"
                    DockPanel.Dock="Right"
                    Text="{Binding ManualSunset, Converter={x:Static converters:TimeOnlyToStringConverter.Instance}, UpdateSourceTrigger=LostFocus}"
                    Theme="{DynamicResource CompactTextBox}" />
            </DockPanel>
            <Slider
                Margin="0,12,0,0"
                LargeChange="0.5"
                Maximum="23.99999"
                Minimum="0"
                SmallChange="0.25"
                Value="{Binding ManualSunset, Converter={x:Static converters:TimeOnlyToHoursDoubleConverter.Instance}}" />
        </StackPanel>

        <!--  Location-based  -->
        <StackPanel
            Margin="0,24,0,0"
            IsVisible="{Binding !IsManualSunriseSunsetEnabled}"
            Orientation="Vertical">
            <!--  Location  -->
            <TextBlock Text="{Binding LocalizationManager.YourLocationLabel}" />
            <Grid Margin="0,8,0,0" ColumnDefinitions="Auto,*,Auto">
                <!--  Autodetect  -->
                <Button
                    Grid.Column="0"
                    Padding="4"
                    VerticalAlignment="Center"
                    Command="{Binding AutoResolveLocationCommand}"
                    Theme="{DynamicResource MaterialFlatButton}"
                    ToolTip.Tip="{Binding LocalizationManager.AutoDetectLocationTooltip}">
                    <materialIcons:MaterialIcon
                        Width="24"
                        Height="24"
                        Kind="Location" />
                </Button>

                <!--  Location query  -->
                <TextBox
                    Grid.Column="1"
                    Margin="8,0"
                    VerticalAlignment="Center"
                    IsEnabled="{Binding !IsBusy}"
                    Text="{Binding LocationQuery}"
                    Theme="{DynamicResource CompactTextBox}">
                    <ToolTip.Tip>
                        <TextBlock MaxWidth="350" Text="{Binding LocalizationManager.LocationQueryTooltip}" TextWrapping="Wrap" />
                    </ToolTip.Tip>
                </TextBox>

                <!--  Set  -->
                <Button
                    Grid.Column="2"
                    Padding="4"
                    VerticalAlignment="Center"
                    Command="{Binding ResolveLocationCommand}"
                    IsDefault="True"
                    Theme="{DynamicResource MaterialFlatButton}"
                    ToolTip.Tip="{Binding LocalizationManager.SetLocationTooltip}">
                    <materialIcons:MaterialIcon
                        Width="24"
                        Height="24"
                        Kind="Tick" />
                </Button>
            </Grid>

            <!--  Location error  -->
            <TextBlock
                Margin="0,8,0,0"
                HorizontalAlignment="Center"
                Foreground="DarkRed"
                IsVisible="{Binding IsLocationError}"
                Text="{Binding LocalizationManager.LocationErrorText}" />
        </StackPanel>
    </StackPanel>
</UserControl>